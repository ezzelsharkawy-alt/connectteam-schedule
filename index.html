<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Joby Schedule Viewer â€” Install</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    @keyframes fadein {
      from { opacity:0; transform:translateY(16px); }
      to   { opacity:1; transform:translateY(0); }
    }
    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(249,108,53,.4); }
      50%       { box-shadow: 0 0 0 12px rgba(249,108,53,0); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50%       { transform: translateY(-6px); }
    }
    .card {
      width: 100%;
      max-width: 560px;
      background: linear-gradient(145deg, rgba(255,255,255,.13), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 40px 100px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.2);
      backdrop-filter: blur(40px);
      -webkit-backdrop-filter: blur(40px);
      border-radius: 28px;
      overflow: hidden;
      animation: fadein .5s cubic-bezier(.22,1,.36,1) forwards;
    }
    .hero {
      padding: 36px 36px 28px;
      text-align: center;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.06), transparent);
    }
    .emoji {
      font-size: 52px;
      display: block;
      margin-bottom: 16px;
      animation: float 3s ease-in-out infinite;
    }
    .hero h1 {
      font-size: 26px;
      font-weight: 800;
      letter-spacing: -.5px;
      margin-bottom: 8px;
    }
    .hero p {
      font-size: 14px;
      color: rgba(255,255,255,.5);
      line-height: 1.6;
      max-width: 380px;
      margin: 0 auto;
    }
    .steps {
      padding: 28px 36px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .step {
      display: flex;
      align-items: flex-start;
      gap: 16px;
    }
    .step-num {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.15);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 800;
      color: rgba(255,255,255,.6);
      flex-shrink: 0;
      margin-top: 2px;
    }
    .step-num.active {
      background: linear-gradient(135deg, #F96C35, #e8420a);
      border: none;
      color: #fff;
      box-shadow: 0 4px 12px rgba(249,108,53,.4);
    }
    .step-content h3 {
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .step-content p {
      font-size: 13px;
      color: rgba(255,255,255,.45);
      line-height: 1.5;
    }
    .bookmarks-tip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 8px;
      padding: 4px 10px;
      font-size: 12px;
      color: rgba(255,255,255,.5);
      margin-top: 6px;
    }
    kbd {
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.2);
      border-radius: 4px;
      padding: 1px 6px;
      font-size: 11px;
      font-family: monospace;
      color: rgba(255,255,255,.7);
    }
    .drag-zone {
      background: rgba(255,255,255,.04);
      border: 1px dashed rgba(255,255,255,.15);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      margin-top: 8px;
    }
    .drag-zone p {
      font-size: 12px;
      color: rgba(255,255,255,.3);
      margin-bottom: 14px;
    }
    .bookmarklet-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, #F96C35, #e8420a);
      color: #fff;
      text-decoration: none;
      border-radius: 14px;
      padding: 13px 24px;
      font-size: 15px;
      font-weight: 700;
      cursor: grab;
      box-shadow: 0 6px 20px rgba(249,108,53,.45);
      animation: pulse 2.5s ease-in-out infinite;
      transition: transform .15s, box-shadow .15s;
      user-select: none;
      -webkit-user-drag: element;
    }
    .bookmarklet-btn:hover {
      transform: scale(1.04);
      box-shadow: 0 8px 28px rgba(249,108,53,.55);
    }
    .bookmarklet-btn:active {
      cursor: grabbing;
    }
    .arrow {
      font-size: 22px;
      display: block;
      margin: 8px auto 0;
      opacity: .4;
      animation: float 2s ease-in-out infinite;
    }
    .divider {
      height: 1px;
      background: rgba(255,255,255,.07);
      margin: 0 36px;
    }
    .footer {
      padding: 16px 36px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }
    .footer p {
      font-size: 12px;
      color: rgba(255,255,255,.25);
    }
    .schedules {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }
    .sched-tag {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 99px;
      padding: 3px 10px;
      font-size: 11px;
      font-weight: 600;
      color: rgba(255,255,255,.6);
    }
    .dot { width:7px; height:7px; border-radius:50%; display:inline-block; }
  </style>
</head>
<body>
<div class="card">
  <!-- Hero -->
  <div class="hero">
    <span class="emoji">ðŸ“…</span>
    <h1>Joby Schedule Viewer</h1>
    <p>See all your shifts across every Connecteam calendar in one beautiful view. Takes 30 seconds to set up.</p>
    <div class="schedules" style="justify-content:center;margin-top:14px">
      <div class="sched-tag"><span class="dot" style="background:#8B5CF6"></span>OAR SN101</div>
      <div class="sched-tag"><span class="dot" style="background:#9CA3AF"></span>SN5/S4-T</div>
      <div class="sched-tag"><span class="dot" style="background:#F97316"></span>OAR SN6</div>
      <div class="sched-tag"><span class="dot" style="background:#3B82F6"></span>OAR SN9</div>
      <div class="sched-tag"><span class="dot" style="background:#EAB308"></span>SN8 Dubai</div>
      <div class="sched-tag"><span class="dot" style="background:#EF4444"></span>SN7 Japan</div>
      <div class="sched-tag"><span class="dot" style="background:#22C55E"></span>GCS VSIL</div>
    </div>
  </div>

  <!-- Steps -->
  <div class="steps">
    <!-- Step 1 -->
    <div class="step">
      <div class="step-num active">1</div>
      <div class="step-content">
        <h3>Show your bookmarks bar</h3>
        <p>If you can't see it, press:</p>
        <div style="display:flex;gap:8px;margin-top:6px;flex-wrap:wrap">
          <div class="bookmarks-tip">Mac: <kbd>âŒ˜</kbd> + <kbd>Shift</kbd> + <kbd>B</kbd></div>
          <div class="bookmarks-tip">Windows: <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>B</kbd></div>
        </div>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step">
      <div class="step-num active">2</div>
      <div class="step-content">
        <h3>Drag this button to your bookmarks bar</h3>
        <p>Click and hold, then drag it up to the bar at the top of your browser.</p>
        <div class="drag-zone">
          <p>ðŸ‘† Drag this up to your bookmarks bar</p>
          <a class="bookmarklet-btn" id="bm-link" href="#">ðŸ“… My Schedule</a>
          <span class="arrow">â†‘</span>
        </div>
      </div>
    </div>

    <!-- Step 3 -->
    <div class="step">
      <div class="step-num active">3</div>
      <div class="step-content">
        <h3>Go to Connecteam and click it!</h3>
        <p>Open <strong style="color:rgba(255,255,255,.8)">app.connecteam.com</strong>, click the bookmark, and your schedule appears instantly. That's it â€” you're done forever.</p>
      </div>
    </div>
  </div>

  <div class="divider"></div>

  <div class="footer">
    <p>Works in Chrome, Safari, Firefox & Edge</p>
    <p>No installs Â· No accounts Â· No data stored</p>
  </div>
</div>

<script>
// Inject the bookmarklet code as the href
const code = `javascript:(function(){const SCHEDULES=[{name:'OAR SN101',color:'#8B5CF6',objectId:'15782348',courseId:'13363740'},{name:'SN5/S4-T',color:'#9CA3AF',objectId:'14461566',courseId:'12300080'},{name:'OAR SN6',color:'#F97316',objectId:'8135671',courseId:'6913463'},{name:'OAR SN9',color:'#3B82F6',objectId:'9263640',courseId:'7861773'},{name:'SN8 Dubai',color:'#EAB308',objectId:'7411131',courseId:'6296158'},{name:'SN7 Japan',color:'#EF4444',objectId:'6664952',courseId:'5649776'},{name:'GCS VSIL Training',color:'#22C55E',objectId:'7412145',courseId:'6297032'}];const WEEKS=3;const TZ='America/Los_Angeles';function getCookie(n){const m=document.cookie.match(new RegExp('(?:^|; )'+n+'=([^;]*)'));return m?decodeURIComponent(m[1]):null;}function getAuth(){return{spirit:getCookie('_spirit'),userId:parseInt(getCookie('user_id'),10)||null};}function getMyName(){const d=document.querySelector('.app-header-user-dropdown');if(d){const lines=d.innerText?.trim().split('\\n').map(s=>s.trim()).filter(s=>s.length>2);if(lines?.[0])return lines[0];}return'You';}function getWeekRanges(){const DAY=86400000,now=new Date(),dow=now.getUTCDay();const satMs=Date.UTC(now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()-(dow===6?0:dow+1))+8*3600000;return Array.from({length:WEEKS},(_,i)=>{const start=new Date(satMs+i*7*DAY),end=new Date(satMs+(i+1)*7*DAY-1);const sun=new Date(start.getTime()+DAY),sat=new Date(end.getTime()-DAY);const fmt=d=>d.toLocaleDateString('en-US',{month:'short',day:'numeric'});return{startDate:start.toISOString(),endDate:end.toISOString(),label:\`\${fmt(sun)} \u2013 \${fmt(sat)}\`};});}async function fetchJobMap(s){try{const r=await fetch(\`https://app.connecteam.com/api/UserDashboard/ShiftScheduler/Data/?objectId=\${s.objectId}&courseId=\${s.courseId}\`,{credentials:'include'});const d=await r.json(),map={};(d?.data?.scheduler_user_data?.jobs||[]).forEach(j=>{map[j.id]=j.title;});return map;}catch{return{};}}async function fetchShifts(sched,week,spirit){try{const r=await fetch('https://app.connecteam.com/api/UserDashboard/ShiftScheduler/Shifts/',{method:'POST',headers:{'Content-Type':'application/json','Cache-Control':'no-cache','Pragma':'no-cache'},credentials:'include',body:JSON.stringify({objectId:sched.objectId,courseId:sched.courseId,startDate:week.startDate,endDate:week.endDate,timezone:TZ,_spirit:spirit})});return(await r.json())?.data?.shifts||[];}catch{return[];}}function formatShift(shift,jobMap,schedName,schedColor){const start=new Date(shift.startTime*1000),end=new Date(shift.endTime*1000);const timeStr=shift.allDay?'All day':\`\${start.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'})} \u2013 \${end.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'})}\`;const label=[(jobMap?.[shift.jobId]||''),(shift.title||'').trim()].filter(Boolean).join(' \u00b7 ')||'Shift';return{timeStr,label,schedName,schedColor,sortKey:shift.startTime,dayKey:start.toISOString().slice(0,10),dayNum:start.getUTCDate()};}function showLoading(){document.getElementById('ct-bm')?.remove();const el=document.createElement('div');el.id='ct-bm';Object.assign(el.style,{position:'fixed',inset:'0',zIndex:'999999',backdropFilter:'blur(24px)',WebkitBackdropFilter:'blur(24px)',background:'rgba(10,10,20,.75)',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif',color:'#fff'});el.innerHTML=\`<div style="background:linear-gradient(145deg,rgba(255,255,255,.14),rgba(255,255,255,.06));border:1px solid rgba(255,255,255,.18);border-radius:28px;padding:40px 50px;text-align:center;box-shadow:0 32px 80px rgba(0,0,0,.4)"><div style="font-size:44px;margin-bottom:14px">\u{1F4C5}</div><div style="font-size:20px;font-weight:800;margin-bottom:6px">Fetching your schedule</div><div style="font-size:13px;color:rgba(255,255,255,.45);margin-bottom:28px">Checking all calendars\u2026</div><div style="width:240px;background:rgba(255,255,255,.1);border-radius:99px;height:4px;overflow:hidden;margin:0 auto"><div id="ct-bar" style="height:4px;width:5%;border-radius:99px;background:linear-gradient(90deg,#F96C35,#ff9a6c);transition:width .4s ease"></div></div></div>\`;document.body.appendChild(el);let p=5;const iv=setInterval(()=>{p=Math.min(p+4,90);const b=document.getElementById('ct-bar');if(b)b.style.width=p+'%';if(!document.getElementById('ct-bm'))clearInterval(iv);},300);return iv;}function showResults(myName,allShifts){document.getElementById('ct-bm')?.remove();const todayKey=new Date().toISOString().slice(0,10);const now=new Date();const sundayMs=Date.UTC(now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()-now.getUTCDay());const shiftsByDay={};allShifts.forEach(s=>{if(!shiftsByDay[s.dayKey])shiftsByDay[s.dayKey]=[];shiftsByDay[s.dayKey].push(s);});const DAY_NAMES=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];const colHeaders=DAY_NAMES.map(d=>\`<div style="text-align:center;font-size:11px;font-weight:700;color:rgba(255,255,255,.4);letter-spacing:.08em;text-transform:uppercase;padding:8px 4px">\${d}</div>\`).join('');const weekRowsHTML=Array.from({length:WEEKS},(_,wi)=>{const wStart=new Date(sundayMs+wi*7*86400000);const wEnd=new Date(wStart.getTime()+6*86400000);const fmt=d=>d.toLocaleDateString('en-US',{month:'short',day:'numeric'});const wLabel=\`\${fmt(wStart)} \u2013 \${fmt(wEnd)}\`;const dayCells=Array.from({length:7},(_,di)=>{const dayMs=sundayMs+(wi*7+di)*86400000;const dayD=new Date(dayMs);const dayKey=dayD.toISOString().slice(0,10);const isToday=dayKey===todayKey;const dayShifts=shiftsByDay[dayKey]||[];const cls=isToday?'today':dayShifts.length>0?'has':'empty';const pills=dayShifts.map(s=>\`<div style="display:flex;align-items:flex-start;gap:6px;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:6px 8px;margin-bottom:4px"><div style="width:2.5px;min-height:28px;border-radius:99px;background:\${s.schedColor};flex-shrink:0;margin-top:1px"></div><div style="min-width:0"><div style="font-size:9px;font-weight:800;letter-spacing:.06em;text-transform:uppercase;color:\${s.schedColor};margin-bottom:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">\${s.schedName}</div><div style="font-size:11px;font-weight:600;color:rgba(255,255,255,.9);line-height:1.3">\${s.label}</div><div style="font-size:10px;color:rgba(255,255,255,.45);margin-top:1px;white-space:nowrap">\${s.timeStr}</div></div></div>\`).join('');return\`<div style="border-radius:14px;padding:10px;position:relative;overflow:hidden;min-height:70px;background:\${isToday?'linear-gradient(145deg,rgba(249,108,53,.3),rgba(249,108,53,.1))':dayShifts.length>0?'linear-gradient(145deg,rgba(255,255,255,.11),rgba(255,255,255,.04))':'rgba(255,255,255,.02)'};border:1px solid \${isToday?'rgba(249,108,53,.45)':dayShifts.length>0?'rgba(255,255,255,.12)':'rgba(255,255,255,.05)'};">\${isToday?'<div style="position:absolute;top:6px;right:6px;background:#F96C35;color:#fff;font-size:7.5px;font-weight:900;padding:2px 6px;border-radius:99px">TODAY</div>':''}<div style="font-size:15px;font-weight:800;color:\${isToday?'#F96C35':dayShifts.length>0?'rgba(255,255,255,.85)':'rgba(255,255,255,.2)'};line-height:1;margin-bottom:\${dayShifts.length>0?'8px':'0'}">\${dayD.getUTCDate()}</div>\${pills}</div>\`;}).join('');return\`<div style="display:contents"><div style="grid-column:1/-1;padding:14px 0 6px;display:flex;align-items:center;gap:12px"><div style="font-size:11px;font-weight:700;color:rgba(255,255,255,.35);letter-spacing:.08em;text-transform:uppercase">Week \${wi+1}</div><div style="font-size:11px;color:rgba(255,255,255,.25)">\${wLabel}</div><div style="flex:1;height:1px;background:rgba(255,255,255,.07)"></div></div>\${dayCells}</div>\`;}).join('');const activeScheds=[...new Map(allShifts.map(s=>[s.schedName,s])).values()];const legendHTML=activeScheds.map(s=>\`<div style="display:inline-flex;align-items:center;gap:6px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);border-radius:99px;padding:4px 12px;font-size:11px;font-weight:700;color:rgba(255,255,255,.8)"><span style="width:7px;height:7px;border-radius:50%;background:\${s.schedColor};display:inline-block;box-shadow:0 0 6px \${s.schedColor}"></span>\${s.schedName}</div>\`).join('');const modal=document.createElement('div');modal.id='ct-bm';Object.assign(modal.style,{position:'fixed',inset:'0',zIndex:'999999',display:'flex',alignItems:'center',justifyContent:'center',fontFamily:'-apple-system,BlinkMacSystemFont,"SF Pro Display","Segoe UI",sans-serif',background:'rgba(10,10,20,.65)',backdropFilter:'blur(24px)',WebkitBackdropFilter:'blur(24px)'});modal.innerHTML=\`<div style="width:96%;max-width:1100px;max-height:90vh;border-radius:28px;overflow:hidden;display:flex;flex-direction:column;background:linear-gradient(145deg,rgba(255,255,255,.14),rgba(255,255,255,.06));border:1px solid rgba(255,255,255,.18);box-shadow:0 40px 100px rgba(0,0,0,.5),inset 0 1px 0 rgba(255,255,255,.2);backdrop-filter:blur(40px);-webkit-backdrop-filter:blur(40px)"><div style="padding:20px 26px 16px;display:flex;align-items:flex-start;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.1);background:linear-gradient(180deg,rgba(255,255,255,.08),transparent);flex-shrink:0"><div><div style="font-size:11px;font-weight:700;color:rgba(255,255,255,.4);letter-spacing:.12em;text-transform:uppercase;margin-bottom:4px">My Schedule</div><div style="font-size:24px;font-weight:800;color:#fff;letter-spacing:-.5px;line-height:1">\${myName}</div><div style="font-size:12px;color:rgba(255,255,255,.45);margin-top:4px">\${allShifts.length} shift\${allShifts.length!==1?'s':''} &nbsp;\u00b7&nbsp; Next \${WEEKS} weeks</div></div><button onclick="document.getElementById('ct-bm').remove()" style="background:linear-gradient(135deg,#F96C35,#e8420a);border:none;color:#fff;border-radius:12px;padding:8px 16px;cursor:pointer;font-size:15px;font-weight:700;box-shadow:0 4px 16px rgba(249,108,53,.4)">\u2715 Close</button></div>\${activeScheds.length>0?\`<div style="padding:10px 26px;border-bottom:1px solid rgba(255,255,255,.08);flex-shrink:0;display:flex;gap:8px;flex-wrap:wrap">\${legendHTML}</div>\":''}<div style="overflow-y:auto;padding:8px 20px 24px;flex:1">\${allShifts.length===0?\`<div style="text-align:center;padding:70px 20px;color:rgba(255,255,255,.4)"><div style="font-size:52px;margin-bottom:16px">\u{1F4C5}</div><div style="font-size:18px;font-weight:700;color:rgba(255,255,255,.6)">No shifts in the next \${WEEKS} weeks</div></div>\`:\`<div style="display:grid;grid-template-columns:repeat(7,1fr);gap:8px">\${colHeaders}\${weekRowsHTML}</div>\`}</div><div style="padding:10px 26px;border-top:1px solid rgba(255,255,255,.08);font-size:11px;color:rgba(255,255,255,.25);display:flex;justify-content:space-between;flex-shrink:0"><span>\u26a1 Fetched via API</span><span>\${new Date().toLocaleTimeString()}</span></div></div>\`;document.body.appendChild(modal);modal.onclick=e=>{if(e.target===modal)modal.remove();};}async function run(){const{spirit,userId}=getAuth();if(!spirit||!userId){alert('Please log into Connecteam first, then click the bookmark again.');return;}const myName=getMyName();const weeks=getWeekRanges();const iv=showLoading();const[jobMaps,...results]=await Promise.all([Promise.all(SCHEDULES.map(s=>fetchJobMap(s))),...SCHEDULES.flatMap((sched,si)=>weeks.map(week=>fetchShifts(sched,week,spirit).then(shifts=>({si,shifts:shifts.filter(s=>s.assignedUserIds?.includes(userId))})).catch(()=>({si,shifts:[]}))))]);clearInterval(iv);const allShifts=[];results.forEach(({si,shifts})=>{shifts.forEach(s=>allShifts.push(formatShift(s,jobMaps[si],SCHEDULES[si].name,SCHEDULES[si].color)));});allShifts.sort((a,b)=>a.sortKey-b.sortKey);showResults(myName,allShifts);}run();})();`;

document.getElementById('bm-link').href = code;
</script>
</body>
</html>
